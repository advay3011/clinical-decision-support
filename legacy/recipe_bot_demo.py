"""Recipe Bot Demo - Non-interactive version for testing"""

import logging
from ddgs import DDGS
from ddgs.exceptions import DDGSException, RatelimitException
from strands import Agent, tool

# Configure logging
logging.getLogger("strands").setLevel(logging.INFO)

# Define a websearch tool
@tool
def websearch(
    keywords: str, region: str = "us-en", max_results: int | None = None
) -> str:
    """Search the web to get updated information.
    Args:
        keywords (str): The search query keywords.
        region (str): The search region: wt-wt, us-en, uk-en, ru-ru, etc..
        max_results (int | None): The maximum number of results to return.
    Returns:
        List of dictionaries with search results.
    """
    try:
        results = DDGS().text(keywords, region=region, max_results=max_results)
        return results if results else "No results found."
    except RatelimitException:
        return "RatelimitException: Please try again after a short delay."
    except DDGSException as d:
        return f"DuckDuckGoSearchException: {d}"
    except Exception as e:
        return f"Exception: {e}"


# Create a recipe assistant agent
recipe_agent = Agent(
    system_prompt="""You are RecipeBot, a helpful cooking assistant.
    Help users find recipes based on ingredients and answer cooking questions.
    Use the websearch tool to find recipes when users mention ingredients or to look up cooking information.""",
    tools=[websearch],
)


if __name__ == "__main__":
    print("\nüë®‚Äçüç≥ RecipeBot Demo - Testing with predefined questions\n")
    print("=" * 60)

    # Test questions
    test_questions = [
        "What's a good pasta recipe?",
        "How do I make chocolate chip cookies?",
        "What can I cook with chicken and rice?",
    ]

    for i, question in enumerate(test_questions, 1):
        print(f"\nüìù Question {i}: {question}")
        print("-" * 60)
        response = recipe_agent(question)
        print(f"ü§ñ RecipeBot: {response}")
        print("=" * 60)

    print("\n‚úÖ Demo completed!")
